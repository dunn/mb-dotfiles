#!/usr/bin/env bash

export HOMEBREW_DEVELOPER=1
export HOMEBREW_INSTALL_BADGE="‚òïÔ∏è üê∏"

alias shsm="shasum -a 256"
alias brwe="brew"
alias audt="brew audit --strict"
alias style="brew style --fix"
alias using="brew uses --installed --recursive"
alias bua="brew upgrade --all"
alias homebrew="cd $(brew --prefix)/Library"

brewp() {
  for f in "$@"; do
    # strip out tap prefixes
    f="$(echo "$f" | sed 's:.*/\([^/]*\)$:\1:')"
    brew home "$f" && brew info --github "$f" && brew search --debian "$f"
  done
}
alias brwep="brewp"

bo() {
  for f in "$@"; do
    open "$(brew --prefix "$f")"
  done
}

bug() {
  brew update
  echo "$(tput setaf 64)--- OUTDATED: ---$(tput sgr0)"
  brew outdated
}

bi() {
  brew remove "$1"
  brew install --verbose --build-from-source "$@"
}

brm() {
  for app in "$@"; do
    using=$(using "$app")
    if [[ "$using" == "" ]]; then
      brew remove "$app"
    else
      echo "$(tput setaf 166) $app is being used by:$(tput sgr0)"
      echo "$using"
    fi
  done
}

brew_install() {
  # Install command-line tools using Homebrew.
  # Make sure we‚Äôre using the latest Homebrew.
  brew update

  # Upgrade any already-installed formulae.
  brew upgrade --all

  # If it isn't already installed
  brew reinstall git --with-persistent-https --with-brewed-openssl --with-pcre --with-brewed-curl
  brew install hub

  # Install GNU core utilities (those that come with OS X are outdated).
  # Don‚Äôt forget to add `$(brew --prefix coreutils)/libexec/gnubin` to `$PATH`.
  brew install coreutils
  brew install gnu-sed
  brew install gawk

  # Install Bash 4.
  # Note: don‚Äôt forget to add `/usr/local/bin/bash` to `/etc/shells` before
  # running `chsh`.
  brew install bash
  brew tap homebrew/versions
  brew install bash-completion2

  # Install emacs
  brew reinstall emacs --with-x11 --with-imagemagick
  brew reinstall aspell --with-lang-en

  # Install wget with IRI support.
  brew reinstall wget --with-iri
  # Install curl with sftp support, necessary for git-ftp
  brew reinstall curl --with-libssh2 --with-openssl --with-libidn

  # Install MAMP stuff
  brew reinstall mysql --with-local-infile
  brew tap homebrew/apache
  brew reinstall httpd24 --with-homebrew-openssl
  brew tap homebrew/php
  brew reinstall php56 --with-apache --homebrew-apxs --with-homebrew-openssl --with-homebrew-curl

  # Email
  brew reinstall mutt --with-confirm-attachment-patch --with-gpgme --with-s-lang --with-trash-patch
  brew install getmail
  brew install msmtp
  brew install gpg-agent

  # Install other good shit
  brew install ag
  brew install ack
  brew install cheat
  brew install editorconfig
  brew install entr
  brew install heroku-toolbelt
  brew install htmlcompressor
  brew reinstall imagemagick --with-x11 --with-webp
  brew reinstall node --with-openssl
  brew install nvm
  brew install pandoc
  brew install pandoc-citeproc
  brew install pngquant
  brew install pigz
  brew reinstall poppler --with-little-cms2
  brew install reattach-to-user-namespace
  brew install rename
  brew install ruby
  brew install src
  brew install surfraw
  brew install tmux
  brew install urlview
  brew install w3m
  brew install youtube-dl
  brew install zopfli

  # Remove outdated versions from the cellar.
  brew cleanup
}
